import{d as B,D as y,ag as K,r as T,H as O,o as z,c as f,v as W,f as s,g as o,b as t,w as a,K as F,t as i,_ as S,h as m,a2 as H,T as $,Q as J,U as Q,a1 as X,an as Z,$ as ee,k as te,l as v}from"./index-C2UrP5hw.js";import{_ as k}from"./Input.vue_vue_type_script_setup_true_lang-CSZ-Dkyw.js";import{_ as C}from"./Label.vue_vue_type_script_setup_true_lang-DVjpD-L7.js";import{_ as se}from"./Textarea.vue_vue_type_script_setup_true_lang--1zaO6ew.js";import{_,a as x}from"./CardContent.vue_vue_type_script_setup_true_lang-eN_1_cPI.js";import{_ as b,a as h}from"./CardTitle.vue_vue_type_script_setup_true_lang-Q0gFftlI.js";import{L as oe}from"./LoadingPage-DgCemYQp.js";import{_ as ae}from"./PageHeader.vue_vue_type_script_setup_true_lang-B1Je6Lxx.js";import{T as le}from"./trash-DxdDRnnN.js";const ne={class:"space-y-6"},ie={key:1,class:"space-y-6"},de={class:"flex items-center justify-between"},re={class:"text-2xl font-bold text-gray-900 mb-2"},ue={class:"flex gap-2"},ce={key:0},me={key:1},pe={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ve={class:"lg:col-span-2 space-y-6"},fe={class:"grid grid-cols-2 gap-4"},ge={class:"col-span-5"},_e={class:"col-span-2"},ye={class:"col-span-3"},xe={class:"col-span-1"},be={class:"text-sm"},he={class:"col-span-1"},we={key:0,class:"grid grid-cols-12 gap-2 items-end bg-gray-50 p-3 rounded-lg"},De={class:"col-span-3"},Ve={class:"text-sm"},Ie={class:"col-span-1"},$e={class:"text-sm font-medium"},ke={key:1,class:"grid grid-cols-12 gap-2 items-end bg-green-50 p-3 rounded-lg"},Ce={class:"col-span-5"},je={class:"text-sm font-medium text-green-700"},Te={key:0,class:"text-xs text-green-600"},Fe={class:"col-span-3"},Se={class:"text-sm text-green-700"},Ne={class:"col-span-1"},Pe={class:"text-sm font-medium text-green-700"},Ae={class:"border-t pt-3"},Re={class:"flex justify-between items-center"},Me={class:"text-xl font-bold"},Ue={class:"space-y-6"},qe={class:"text-sm"},Le={class:"text-sm"},Ee={class:"text-sm"},Ge={class:"text-sm capitalize"},Ye={class:"text-sm"},Be={class:"text-sm"},Ke={class:"text-sm"},Oe={class:"text-sm"},ze={class:"flex justify-between"},We={class:"text-sm font-medium"},He={key:0,class:"flex justify-between"},Je={class:"text-sm font-medium"},Qe={key:1,class:"flex justify-between text-green-600"},Xe={class:"text-sm font-medium"},Ze={class:"border-t pt-2 flex justify-between"},et={class:"font-bold text-lg"},ct=B({__name:"index",setup(tt){const A=K(),R=te(),w=y(()=>A.params.id),N=T(!0),D=T(!1),l=T(null),r=T({invoiceNumber:"",dueDate:"",items:[],notes:""}),M=y(()=>{var n;return[{count:1,label:"Projects",href:"/studio/projects",action:!0},{count:2,label:((n=l.value)==null?void 0:n.name)||`Project ${w.value}`,href:`/studio/projects/${w.value}`,action:!0},{count:3,label:"Create Invoice",href:`/studio/projects/${w.value}/invoice`,action:!1}]}),j=y(()=>r.value.items.reduce((n,e)=>n+e.quantity*e.price,0)),V=y(()=>{var n;return((n=l.value)==null?void 0:n.transportCost)||0}),I=y(()=>{var e;if(!((e=l.value)!=null&&e.discount))return 0;const n=j.value+V.value;return l.value.discount.type==="percentage"?n*(l.value.discount.value/100):l.value.discount.value}),P=y(()=>Math.max(0,j.value+V.value-I.value)),U=n=>new Intl.DateTimeFormat("en-MY",{year:"numeric",month:"short",day:"numeric"}).format(n),q=()=>{r.value.items.push({description:"",quantity:1,price:0})},L=n=>{r.value.items.splice(n,1)},E=()=>{F.info("Invoice preview would open in a new window")},G=async()=>{if(l.value){D.value=!0;try{await new Promise(e=>setTimeout(e,1500));const n={...r.value,project:l.value,subtotal:j.value,transportCost:V.value,discount:I.value,total:P.value,generatedAt:new Date};F.success("Invoice generated successfully!"),R.push(`/studio/projects/${w.value}`)}catch(n){console.error("Error generating invoice:",n),F.error("Failed to generate invoice")}finally{D.value=!1}}};O(()=>l.value,n=>{if(n){const d=new Date().toISOString().slice(0,7).replace("-","");r.value.invoiceNumber=`INV-${d}-${String(Math.floor(Math.random()*1e3)).padStart(3,"0")}`;const p=new Date;p.setDate(p.getDate()+30),r.value.dueDate=p.toISOString().split("T")[0],r.value.items=[{description:`${n.type.charAt(0).toUpperCase()+n.type.slice(1)} Photography Package`,quantity:1,price:n.budget||0}],n.sessions&&n.sessions.length>0&&n.sessions.forEach(u=>{r.value.items.push({description:`Photography Session - ${u.title}`,quantity:1,price:0})}),r.value.notes="Payment is due within 30 days of invoice date. Thank you for choosing our photography services!"}},{immediate:!0});const Y=async()=>{try{N.value=!0,await new Promise(e=>setTimeout(e,1e3));const n={id:w.value,name:"Sarah & John Wedding",description:"Full wedding photography package for outdoor ceremony",type:"wedding",status:"in-progress",client:{id:"c1",name:"Sarah Johnson",email:"sarah.johnson@email.com",phone:"+60123456789"},budget:8500,eventDate:new Date("2024-03-15"),deliveryDate:new Date("2024-04-15"),createdAt:new Date("2024-01-15"),convertedFromFormId:"form_1",convertedFromResponseId:"resp_1",location:"Kuala Lumpur Garden Resort",photographer:{id:"p1",name:"Alex Smith"},sessions:[{id:"s1",title:"Ceremony",time:"2024-03-15T14:00",venue:"Garden Pavilion, KL Garden Resort",notes:"Outdoor ceremony, backup indoor location available",createdAt:new Date,updatedAt:new Date},{id:"s2",title:"Reception",time:"2024-03-15T18:00",venue:"Grand Ballroom, KL Garden Resort",notes:"Evening reception with 200 guests",createdAt:new Date,updatedAt:new Date}],assignedShooters:[{id:"1",name:"Alex Smith",email:"alex@example.com",role:"main",specialties:["Wedding","Portrait"],dailyRate:800,isActive:!0}],internalTags:[{id:"vip",name:"VIP",color:"purple",priority:"high"},{id:"premium",name:"Premium",color:"yellow",priority:"medium"}],transportCost:150,internalNotes:"High-profile client, ensure extra attention to detail",notes:"Client prefers natural lighting and candid shots",discount:{type:"percentage",value:10,reason:"Early bird discount",appliedAt:new Date("2024-01-20")}};l.value=n}catch(n){console.error("Error loading project:",n),F.error("Failed to load project details")}finally{N.value=!1}};return z(()=>{Y()}),(n,e)=>(v(),f("div",ne,[N.value?(v(),W(s(oe),{key:0,title:"Loading project details",description:"We're preparing the invoice generation workspace."})):(v(),f("div",ie,[o(ae,{breadcrumb:M.value},null,8,["breadcrumb"]),o(s(_),{class:"p-6"},{default:a(()=>{var d;return[t("div",de,[t("div",null,[t("h1",re," Create Invoice - "+i((d=l.value)==null?void 0:d.name),1),e[3]||(e[3]=t("p",{class:"text-gray-600"}," Generate a professional invoice for this photography project. ",-1))]),t("div",ue,[o(s(S),{onClick:E,variant:"outline",disabled:D.value},{default:a(()=>e[4]||(e[4]=[m(" Preview ")])),_:1},8,["disabled"]),o(s(S),{onClick:G,disabled:D.value},{default:a(()=>[D.value?(v(),f("span",ce,"Generating...")):(v(),f("span",me,"Generate Invoice"))]),_:1},8,["disabled"])])])]}),_:1}),t("div",pe,[t("div",ve,[o(s(_),null,{default:a(()=>[o(s(b),null,{default:a(()=>[o(s(h),null,{default:a(()=>e[5]||(e[5]=[m("Invoice Details")])),_:1})]),_:1}),o(s(x),{class:"space-y-4"},{default:a(()=>[t("div",fe,[t("div",null,[o(s(C),{for:"invoice-number"},{default:a(()=>e[6]||(e[6]=[m("Invoice Number")])),_:1}),o(s(k),{id:"invoice-number",modelValue:r.value.invoiceNumber,"onUpdate:modelValue":e[0]||(e[0]=d=>r.value.invoiceNumber=d),placeholder:"INV-2024-001",class:"mt-1"},null,8,["modelValue"])]),t("div",null,[o(s(C),{for:"due-date"},{default:a(()=>e[7]||(e[7]=[m("Due Date")])),_:1}),o(s(k),{id:"due-date",modelValue:r.value.dueDate,"onUpdate:modelValue":e[1]||(e[1]=d=>r.value.dueDate=d),type:"date",class:"mt-1"},null,8,["modelValue"])])])]),_:1})]),_:1}),o(s(_),null,{default:a(()=>[o(s(b),null,{default:a(()=>[o(s(h),{class:"flex items-center justify-between"},{default:a(()=>[e[9]||(e[9]=m(" Invoice Items ")),o(s(S),{onClick:q,size:"sm",class:"flex items-center gap-2"},{default:a(()=>[o(s(H),{class:"w-4 h-4"}),e[8]||(e[8]=m(" Add Item "))]),_:1})]),_:1})]),_:1}),o(s(x),{class:"space-y-3"},{default:a(()=>{var d,p;return[(v(!0),f(J,null,Q(r.value.items,(u,c)=>(v(),f("div",{key:c,class:"grid grid-cols-12 gap-2 items-end"},[t("div",ge,[o(s(C),{for:`item-description-${c}`},{default:a(()=>e[10]||(e[10]=[m("Description")])),_:2},1032,["for"]),o(s(k),{id:`item-description-${c}`,modelValue:u.description,"onUpdate:modelValue":g=>u.description=g,placeholder:"Photography session",class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue"])]),t("div",_e,[o(s(C),{for:`item-quantity-${c}`},{default:a(()=>e[11]||(e[11]=[m("Qty")])),_:2},1032,["for"]),o(s(k),{id:`item-quantity-${c}`,modelValue:u.quantity,"onUpdate:modelValue":g=>u.quantity=g,type:"number",min:"1",class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue"])]),t("div",ye,[o(s(C),{for:`item-price-${c}`},{default:a(()=>e[12]||(e[12]=[m("Price (MYR)")])),_:2},1032,["for"]),o(s(k),{id:`item-price-${c}`,modelValue:u.price,"onUpdate:modelValue":g=>u.price=g,type:"number",step:"0.01",min:"0",class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue"])]),t("div",xe,[e[13]||(e[13]=t("p",{class:"text-sm font-medium text-gray-600"},"Total",-1)),t("p",be,i((u.quantity*u.price).toFixed(2)),1)]),t("div",he,[o(s(S),{onClick:g=>L(c),variant:"ghost",size:"sm",class:"text-red-600 hover:text-red-700"},{default:a(()=>[o(s(le),{class:"w-4 h-4"})]),_:2},1032,["onClick"])])]))),128)),(d=l.value)!=null&&d.transportCost?(v(),f("div",we,[e[14]||(e[14]=t("div",{class:"col-span-5"},[t("p",{class:"text-sm font-medium"},"Transport Cost")],-1)),e[15]||(e[15]=t("div",{class:"col-span-2"},[t("p",{class:"text-sm"},"1")],-1)),t("div",De,[t("p",Ve,i(l.value.transportCost.toFixed(2)),1)]),t("div",Ie,[t("p",$e,i(l.value.transportCost.toFixed(2)),1)]),e[16]||(e[16]=t("div",{class:"col-span-1"},null,-1))])):$("",!0),(p=l.value)!=null&&p.discount?(v(),f("div",ke,[t("div",Ce,[t("p",je,[e[17]||(e[17]=m(" Discount ")),l.value.discount.reason?(v(),f("span",Te," ("+i(l.value.discount.reason)+") ",1)):$("",!0)])]),e[18]||(e[18]=t("div",{class:"col-span-2"},[t("p",{class:"text-sm"},"1")],-1)),t("div",Fe,[t("p",Se," -"+i(l.value.discount.type==="percentage"?`${l.value.discount.value}%`:`${l.value.discount.value.toFixed(2)} MYR`),1)]),t("div",Ne,[t("p",Pe,"-"+i(I.value.toFixed(2)),1)]),e[19]||(e[19]=t("div",{class:"col-span-1"},null,-1))])):$("",!0),t("div",Ae,[t("div",Re,[e[20]||(e[20]=t("p",{class:"text-lg font-semibold"},"Total Amount",-1)),t("p",Me,"MYR "+i(P.value.toFixed(2)),1)])])]}),_:1})]),_:1}),o(s(_),null,{default:a(()=>[o(s(b),null,{default:a(()=>[o(s(h),null,{default:a(()=>e[21]||(e[21]=[m("Additional Notes")])),_:1})]),_:1}),o(s(x),null,{default:a(()=>[o(s(se),{modelValue:r.value.notes,"onUpdate:modelValue":e[2]||(e[2]=d=>r.value.notes=d),placeholder:"Payment terms, additional instructions...",rows:"4"},null,8,["modelValue"])]),_:1})]),_:1})]),t("div",Ue,[o(s(_),null,{default:a(()=>[o(s(b),null,{default:a(()=>[o(s(h),{class:"flex items-center gap-2"},{default:a(()=>[o(s(X),{class:"w-5 h-5"}),e[22]||(e[22]=m(" Client Information "))]),_:1})]),_:1}),o(s(x),{class:"space-y-3"},{default:a(()=>{var d,p,u,c;return[t("div",null,[e[23]||(e[23]=t("p",{class:"text-sm font-medium text-gray-600"},"Name",-1)),t("p",qe,i((d=l.value)==null?void 0:d.client.name),1)]),t("div",null,[e[24]||(e[24]=t("p",{class:"text-sm font-medium text-gray-600"},"Email",-1)),t("p",Le,i((p=l.value)==null?void 0:p.client.email),1)]),t("div",null,[e[25]||(e[25]=t("p",{class:"text-sm font-medium text-gray-600"},"Phone",-1)),t("p",Ee,i(((u=l.value)==null?void 0:u.client.phone)||"Not provided"),1)]),t("div",null,[e[26]||(e[26]=t("p",{class:"text-sm font-medium text-gray-600"},"Project Type",-1)),t("p",Ge,i((c=l.value)==null?void 0:c.type),1)])]}),_:1})]),_:1}),o(s(_),null,{default:a(()=>[o(s(b),null,{default:a(()=>[o(s(h),{class:"flex items-center gap-2"},{default:a(()=>[o(s(Z),{class:"w-5 h-5"}),e[27]||(e[27]=m(" Project Summary "))]),_:1})]),_:1}),o(s(x),{class:"space-y-3"},{default:a(()=>{var d,p,u,c,g;return[t("div",null,[e[28]||(e[28]=t("p",{class:"text-sm font-medium text-gray-600"},"Project Name",-1)),t("p",Ye,i((d=l.value)==null?void 0:d.name),1)]),t("div",null,[e[29]||(e[29]=t("p",{class:"text-sm font-medium text-gray-600"},"Event Date",-1)),t("p",Be,i((p=l.value)!=null&&p.eventDate?U(l.value.eventDate):"Not scheduled"),1)]),t("div",null,[e[30]||(e[30]=t("p",{class:"text-sm font-medium text-gray-600"},"Location",-1)),t("p",Ke,i(((u=l.value)==null?void 0:u.location)||"Not specified"),1)]),t("div",null,[e[31]||(e[31]=t("p",{class:"text-sm font-medium text-gray-600"},"Sessions",-1)),t("p",Oe,i(((g=(c=l.value)==null?void 0:c.sessions)==null?void 0:g.length)||0)+" session(s)",1)])]}),_:1})]),_:1}),o(s(_),null,{default:a(()=>[o(s(b),null,{default:a(()=>[o(s(h),{class:"flex items-center gap-2"},{default:a(()=>[o(s(ee),{class:"w-5 h-5"}),e[32]||(e[32]=m(" Invoice Summary "))]),_:1})]),_:1}),o(s(x),{class:"space-y-3"},{default:a(()=>[t("div",ze,[e[33]||(e[33]=t("span",{class:"text-sm text-gray-600"},"Subtotal:",-1)),t("span",We,"MYR "+i(j.value.toFixed(2)),1)]),V.value>0?(v(),f("div",He,[e[34]||(e[34]=t("span",{class:"text-sm text-gray-600"},"Transport:",-1)),t("span",Je,"MYR "+i(V.value.toFixed(2)),1)])):$("",!0),I.value>0?(v(),f("div",Qe,[e[35]||(e[35]=t("span",{class:"text-sm"},"Discount:",-1)),t("span",Xe,"-MYR "+i(I.value.toFixed(2)),1)])):$("",!0),t("div",Ze,[e[36]||(e[36]=t("span",{class:"font-semibold"},"Total:",-1)),t("span",et,"MYR "+i(P.value.toFixed(2)),1)])]),_:1})]),_:1})])])]))]))}});export{ct as default};

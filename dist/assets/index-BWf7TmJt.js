import{d as ae,D as z,ag as oe,r as f,H as le,o as ie,c as i,e as ne,T as g,g as a,b as t,f as o,t as m,w as r,K as w,a2 as M,h as u,_ as x,Q as A,U as C,W as D,j as re,ac as de,ad as ue,ae as ce,k as me,l as n,ab as pe}from"./index-C2UrP5hw.js";import{_ as fe}from"./Input.vue_vue_type_script_setup_true_lang-CSZ-Dkyw.js";import{_ as $}from"./Label.vue_vue_type_script_setup_true_lang-DVjpD-L7.js";import{_ as b}from"./index-BFTYKSG-.js";import{_ as ve}from"./Switch.vue_vue_type_script_setup_true_lang-Dig9Qbto.js";import{_ as B,a as I}from"./CardContent.vue_vue_type_script_setup_true_lang-eN_1_cPI.js";import{_ as ge,S as xe,L as ye}from"./CardFooter.vue_vue_type_script_setup_true_lang-CJCkOrCH.js";import{_ as J,a as E}from"./CardTitle.vue_vue_type_script_setup_true_lang-Q0gFftlI.js";import{_ as be,a as _e}from"./AddAddonModal.vue_vue_type_script_setup_true_lang-xUEZGAPh.js";import{s as he,P as ke}from"./sessionTypes-C4leSnHL.js";import{I as we}from"./info-fY2g-SHG.js";import{C as S}from"./check-CMqAtv7z.js";import{A as Se}from"./arrow-right-eDIw2xme.js";import"./useFormControl-BTKw-cda.js";import"./VisuallyHiddenInput-CveaDp_Q.js";import"./Textarea.vue_vue_type_script_setup_true_lang--1zaO6ew.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CGEsSMnb.js";import"./DialogDescription.vue_vue_type_script_setup_true_lang-CGpZvTRB.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-zsfmxkQJ.js";const Ae={class:"space-y-6"},Ce={key:0,class:"p-4 bg-gradient-to-r from-blue-50 to-blue-50 dark:from-blue-900/20 dark:to-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},$e={class:"flex items-center gap-3"},Pe={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},Te={class:"text-sm font-semibold text-blue-800 dark:text-blue-200"},Fe={class:"flex items-center gap-3"},Ne={class:"p-2 bg-purple-100 dark:bg-purple-900/20 rounded-lg"},Ue={class:"flex justify-end"},Ve={class:"space-y-6"},Me={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Re={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},je=["onClick"],Oe={key:0,class:"absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center"},ze={class:"space-y-3"},De={class:"font-semibold text-gray-900 dark:text-gray-100 text-lg"},Be={class:"flex items-center gap-2 mt-1"},Ie={key:0,class:"text-sm text-muted-foreground mt-2"},Je={class:"flex items-center justify-between pt-2"},Ee={key:0,class:"text-sm font-medium text-purple-600 dark:text-purple-400"},Le={key:1,class:"text-sm text-muted-foreground group-hover:text-gray-700 dark:group-hover:text-gray-300"},Qe={key:2,class:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg"},Ye={key:0,class:"mt-8 pt-8 border-t border-gray-200 dark:border-gray-700"},He={class:"flex items-center justify-between mb-6"},Ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},qe={class:"flex items-start justify-between mb-4"},Ge={class:"flex-1"},We={class:"font-semibold text-gray-900 dark:text-gray-100 text-lg mb-2"},Xe={class:"flex items-center gap-2 mb-2"},Ze={class:"space-y-4"},es={class:"relative"},ss={key:0,class:"flex items-center gap-2 text-sm mt-2"},ts={class:"flex items-center space-x-2"},as={key:0,class:"mt-3"},os={class:"mt-2 space-y-2"},ls=["id","onUpdate:modelValue","value"],is={key:0,class:"text-xs text-muted-foreground mt-2"},ns={class:"flex items-center gap-2 text-sm text-muted-foreground"},rs={class:"flex items-center gap-1"},ds={key:0,class:"w-2 h-2 bg-green-500 rounded-full"},us={key:1,class:"w-2 h-2 bg-orange-500 rounded-full"},cs={key:2,class:"w-2 h-2 bg-muted-foreground rounded-full"},ms={key:0},ps={key:1},fs={key:2},vs={class:"flex items-center gap-3"},gs={key:0,class:"flex items-center gap-2"},xs={key:1,class:"flex items-center gap-2"},ys={key:0,class:"flex items-center gap-2"},bs={key:1,class:"flex items-center gap-2"},_s={class:"flex items-center gap-3"},hs={class:"p-2 bg-amber-100 dark:bg-amber-900/20 rounded-lg"},ks={class:"space-y-2 text-sm text-muted-foreground"},ws={class:"flex items-start gap-2"},Ss={class:"flex items-start gap-2"},As={class:"flex items-start gap-2"},Cs={class:"flex items-start gap-2"},$s=ae({__name:"index",setup(Ps){const L=oe(),R=me(),Q=z(()=>L.params.id),p=f([]),P=f(!1),_=f(!1),T=f(null),j=f([]),d=f({selectedAddons:[],selectedSessionTypes:[]}),F=f({selectedAddons:[],selectedSessionTypes:[]}),v=f(!1),y=f(!1),N=z(()=>JSON.stringify(d.value.selectedAddons)!==JSON.stringify(F.value.selectedAddons));let U=null;const Y=()=>{U&&clearTimeout(U),U=setTimeout(()=>{N.value&&V(!0)},3e3)};le(()=>d.value.selectedAddons,()=>{y.value=!1,Y()},{deep:!0});const H=async()=>{try{P.value=!0;const l=await _e.getAddons();p.value=l.addons}catch(l){console.error("Error loading addons:",l),w.error("Failed to load add-ons")}finally{P.value=!1}},K=async()=>{try{const l=await he.getSessionTypes();j.value=l.sessionTypes}catch(l){console.error("Error loading session types:",l)}},h=l=>d.value.selectedAddons.some(e=>e.id===l),O=l=>{const e=d.value.selectedAddons.findIndex(s=>s.id===l);if(e>-1)d.value.selectedAddons.splice(e,1);else{const s=p.value.find(c=>c.id===l);d.value.selectedAddons.push({id:l,customPrice:(s==null?void 0:s.price)||0,hasSessionRestriction:!1,availableForSessions:[]})}},q=l=>{const e=p.value.find(s=>s.id===l);return(e==null?void 0:e.name)||"Unknown Add-on"},k=l=>{const e=p.value.find(s=>s.id===l);return(e==null?void 0:e.price.toFixed(2))||"0.00"},G=l=>{const e=p.value.find(s=>s.id===l);return(e==null?void 0:e.maxQuantity)||1},W=l=>{const e=j.value.find(s=>s.id===l);return(e==null?void 0:e.name)||"Unknown Session"},X=l=>{T.value=l,_.value=!0},Z=l=>{p.value.push(l),d.value.selectedAddons.push({id:l.id,customPrice:l.price,hasSessionRestriction:!1,availableForSessions:[]}),w.success("Add-on added successfully!")},ee=l=>{const e=p.value.findIndex(s=>s.id===l.id);if(e>-1){p.value[e]=l;const s=d.value.selectedAddons.findIndex(c=>c.id===l.id);s>-1&&(d.value.selectedAddons[s].customPrice=l.price)}w.success("Add-on updated successfully!")},V=async(l=!1)=>{try{v.value=!0,await new Promise(e=>setTimeout(e,1e3)),F.value=JSON.parse(JSON.stringify(d.value)),y.value=!0,l||w.success("Add-ons saved successfully!")}catch(e){console.error("Error saving form data:",e),l||w.error("Failed to save add-ons")}finally{v.value=!1}},se=async()=>{await V(),y.value&&R.push(`/studio/forms/${Q.value}/fields`)};return ie(()=>{H(),K(),F.value=JSON.parse(JSON.stringify(d.value)),y.value=!0}),(l,e)=>(n(),i("div",Ae,[e[34]||(e[34]=ne('<div class="space-y-2" data-v-6431e772><h1 class="text-2xl font-bold text-foreground" data-v-6431e772>Add-ons</h1><p class="text-muted-foreground" data-v-6431e772> Optional items clients can add to their booking. You can customize the price for each add-on in your form. </p></div><div class="flex items-center gap-2 text-sm text-muted-foreground" data-v-6431e772><div class="flex items-center gap-1" data-v-6431e772><div class="w-2 h-2 bg-primary rounded-full" data-v-6431e772></div><span data-v-6431e772>Step 3 of 6</span></div><span data-v-6431e772>•</span><span data-v-6431e772>Add-ons</span></div>',2)),d.value.selectedAddons.length>0?(n(),i("div",Ce,[t("div",$e,[t("div",Pe,[a(o(we),{class:"w-4 h-4 text-white"})]),t("div",null,[t("span",Te,m(d.value.selectedAddons.length)+" add-on"+m(d.value.selectedAddons.length>1?"s":"")+" selected ",1),e[4]||(e[4]=t("p",{class:"text-xs text-blue-600 dark:text-blue-300"}," Optional add-ons configured ",-1))])])])):g("",!0),a(o(B),null,{default:r(()=>[a(o(J),null,{default:r(()=>[t("div",Fe,[t("div",Ne,[a(o(M),{class:"w-5 h-5 text-purple-600 dark:text-purple-400"})]),t("div",null,[a(o(E),null,{default:r(()=>e[5]||(e[5]=[u("Available Add-ons")])),_:1}),e[6]||(e[6]=t("p",{class:"text-sm text-muted-foreground mt-1"}," Select and customize the add-ons you offer ",-1))])]),t("div",Ue,[a(o(x),{onClick:e[0]||(e[0]=s=>_.value=!0),variant:"outline",size:"sm"},{default:r(()=>[a(o(M),{class:"w-4 h-4 mr-2"}),e[7]||(e[7]=u(" Add New Add-on "))]),_:1})])]),_:1}),a(o(I),null,{default:r(()=>[t("div",Ve,[P.value?(n(),i("div",Me,[(n(),i(A,null,C(6,s=>t("div",{key:s,class:"border rounded-lg p-4 animate-pulse"},e[8]||(e[8]=[t("div",{class:"h-4 bg-gray-200 rounded mb-2"},null,-1),t("div",{class:"h-3 bg-gray-200 rounded mb-3"},null,-1),t("div",{class:"h-6 bg-gray-200 rounded"},null,-1)]))),64))])):p.value.length>0?(n(),i("div",Re,[(n(!0),i(A,null,C(p.value,s=>(n(),i("div",{key:s.id,class:D(["relative border rounded-lg p-4 transition-all duration-200 group cursor-pointer",{"border-purple-500 bg-purple-50 dark:bg-purple-900/20 ring-2 ring-purple-200 dark:ring-purple-800":h(s.id),"border-gray-200 hover:border-gray-300 hover:shadow-md":!h(s.id)}]),onClick:c=>O(s.id)},[h(s.id)?(n(),i("div",Oe,[a(o(S),{class:"w-4 h-4 text-white"})])):g("",!0),a(o(x),{onClick:re(c=>X(s),["stop"]),variant:"ghost",size:"sm",class:D(["absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",{"right-10":h(s.id)}])},{default:r(()=>[a(o(ke),{class:"w-4 h-4"})]),_:2},1032,["onClick","class"]),t("div",ze,[t("div",null,[t("h4",De,m(s.name),1),t("div",Be,[e[9]||(e[9]=t("span",{class:"text-sm text-muted-foreground"},"Price:",-1)),a(o(b),{variant:"outline",class:"text-sm font-medium"},{default:r(()=>[u(" MYR "+m(s.price.toFixed(2)),1)]),_:2},1024),e[10]||(e[10]=t("span",{class:"text-sm text-muted-foreground"},"Max:",-1)),a(o(b),{variant:"outline",class:"text-sm font-medium"},{default:r(()=>[u(m(s.maxQuantity),1)]),_:2},1024)]),s.description?(n(),i("p",Ie,m(s.description),1)):g("",!0)]),t("div",Je,[h(s.id)?(n(),i("span",Ee," ✓ Selected ")):(n(),i("span",Le," Click to select "))])])],10,je))),128))])):(n(),i("div",Qe,[e[12]||(e[12]=t("div",{class:"mb-4"},[t("svg",{class:"w-12 h-12 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})])],-1)),e[13]||(e[13]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2"}," No add-ons available ",-1)),e[14]||(e[14]=t("p",{class:"text-gray-500 mb-4"}," Create your first add-on to get started ",-1)),a(o(x),{onClick:e[1]||(e[1]=s=>_.value=!0),variant:"outline"},{default:r(()=>[a(o(M),{class:"w-4 h-4 mr-2"}),e[11]||(e[11]=u(" Add Add-on "))]),_:1})]))]),d.value.selectedAddons.length>0?(n(),i("div",Ye,[t("div",He,[e[15]||(e[15]=t("div",null,[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"}," Selected Add-ons "),t("p",{class:"text-sm text-muted-foreground mt-1"}," Customize pricing and availability for your selected add-ons ")],-1)),a(o(b),{variant:"secondary",class:"px-3 py-1"},{default:r(()=>[u(m(d.value.selectedAddons.length)+" selected ",1)]),_:1})]),t("div",Ke,[(n(!0),i(A,null,C(d.value.selectedAddons,s=>(n(),i("div",{key:s.id,class:"p-6 bg-gradient-to-br from-purple-50 to-purple-50 dark:from-purple-900/10 dark:to-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg"},[t("div",qe,[t("div",Ge,[t("h4",We,m(q(s.id)),1),t("div",Xe,[e[16]||(e[16]=t("span",{class:"text-sm text-muted-foreground"},"Base Price:",-1)),a(o(b),{variant:"outline",class:"text-sm"},{default:r(()=>[u(" RM "+m(k(s.id)),1)]),_:2},1024),e[17]||(e[17]=t("span",{class:"text-sm text-muted-foreground"},"Max:",-1)),a(o(b),{variant:"outline",class:"text-sm"},{default:r(()=>[u(m(G(s.id)),1)]),_:2},1024)])]),a(o(x),{onClick:c=>O(s.id),variant:"ghost",size:"sm",class:"text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"},{default:r(()=>[a(o(de),{class:"w-4 h-4"})]),_:2},1032,["onClick"])]),t("div",Ze,[t("div",null,[a(o($),{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},{default:r(()=>e[18]||(e[18]=[u(" Custom Form Price (MYR) ")])),_:1}),e[21]||(e[21]=t("p",{class:"text-xs text-muted-foreground mb-2"}," This price will be displayed to clients in your form ",-1)),t("div",es,[a(o(fe),{modelValue:s.customPrice,"onUpdate:modelValue":c=>s.customPrice=c,modelModifiers:{number:!0},type:"number",step:"0.01",min:"0",placeholder:"0.00",class:"w-full pl-12 text-lg font-medium"},null,8,["modelValue","onUpdate:modelValue"]),e[19]||(e[19]=t("div",{class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"},[t("span",{class:"text-muted-foreground font-medium"},"RM")],-1))]),s.customPrice!=null&&s.customPrice!==parseFloat(k(s.id))?(n(),i("div",ss,[e[20]||(e[20]=t("span",{class:"text-muted-foreground"},"Difference:",-1)),a(o(b),{variant:s.customPrice>parseFloat(k(s.id))?"default":"secondary",class:"text-xs"},{default:r(()=>[u(m(s.customPrice>parseFloat(k(s.id))?"+":"")+" RM "+m((s.customPrice-parseFloat(k(s.id))).toFixed(2)),1)]),_:2},1032,["variant"])])):g("",!0)]),t("div",ts,[a(o(ve),{modelValue:s.hasSessionRestriction,"onUpdate:modelValue":c=>s.hasSessionRestriction=c},null,8,["modelValue","onUpdate:modelValue"]),a(o($),{class:"text-sm"},{default:r(()=>e[22]||(e[22]=[u("Session specific")])),_:1})]),s.hasSessionRestriction?(n(),i("div",as,[a(o($),{class:"text-sm"},{default:r(()=>e[23]||(e[23]=[u("Available for sessions:")])),_:1}),t("div",os,[(n(!0),i(A,null,C(d.value.selectedSessionTypes,c=>(n(),i("div",{key:c.id,class:"flex items-center space-x-2"},[ue(t("input",{type:"checkbox",id:`addon-${s.id}-session-${c.id}`,"onUpdate:modelValue":te=>s.availableForSessions=te,value:c.id,class:"rounded"},null,8,ls),[[ce,s.availableForSessions]]),a(o($),{for:`addon-${s.id}-session-${c.id}`,class:"text-sm"},{default:r(()=>[u(m(W(c.id)),1)]),_:2},1032,["for"])]))),128))]),d.value.selectedSessionTypes.length===0?(n(),i("p",is," No sessions selected yet. Go to Sessions step to select sessions first. ")):g("",!0)])):g("",!0)])]))),128))])])):g("",!0)]),_:1}),a(o(ge),{class:"flex items-center justify-between bg-muted/30"},{default:r(()=>[t("div",ns,[t("div",rs,[y.value?(n(),i("div",ds)):N.value?(n(),i("div",us)):(n(),i("div",cs))]),y.value?(n(),i("span",ms,"Saved")):N.value?(n(),i("span",ps,"Unsaved changes")):(n(),i("span",fs,"Ready to save"))]),t("div",vs,[a(o(x),{onClick:e[2]||(e[2]=s=>o(R).back()),variant:"outline",disabled:v.value},{default:r(()=>e[24]||(e[24]=[u(" Back ")])),_:1},8,["disabled"]),a(o(x),{onClick:V,variant:"outline",disabled:v.value,class:"min-w-[100px]"},{default:r(()=>[v.value?(n(),i("div",gs,e[25]||(e[25]=[t("div",{class:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"},null,-1),u(" Saving... ")]))):(n(),i("div",xs,[a(o(xe),{class:"w-4 h-4"}),e[26]||(e[26]=u(" Save Changes "))]))]),_:1},8,["disabled"]),a(o(x),{onClick:se,disabled:v.value,class:"min-w-[120px]"},{default:r(()=>[v.value?(n(),i("div",ys,e[27]||(e[27]=[t("div",{class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1),u(" Saving... ")]))):(n(),i("div",bs,[a(o(Se),{class:"w-4 h-4"}),e[28]||(e[28]=u(" Continue to Fields "))]))]),_:1},8,["disabled"])])]),_:1})]),_:1}),a(o(B),null,{default:r(()=>[a(o(J),null,{default:r(()=>[t("div",_s,[t("div",hs,[a(o(ye),{class:"w-5 h-5 text-amber-600 dark:text-amber-400"})]),a(o(E),{class:"text-base"},{default:r(()=>e[29]||(e[29]=[u("Add-on Tips")])),_:1})])]),_:1}),a(o(I),null,{default:r(()=>[t("ul",ks,[t("li",ws,[a(o(S),{class:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e[30]||(e[30]=t("span",null," Add-ons are optional extras that can increase your booking value ",-1))]),t("li",Ss,[a(o(S),{class:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e[31]||(e[31]=t("span",null," Use session restrictions to offer relevant add-ons for specific sessions ",-1))]),t("li",As,[a(o(S),{class:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e[32]||(e[32]=t("span",null," Set maximum quantities to control how many clients can select ",-1))]),t("li",Cs,[a(o(S),{class:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),e[33]||(e[33]=t("span",null," Clear descriptions help clients understand the value of each add-on ",-1))])])]),_:1})]),_:1}),a(be,{"is-open":_.value,"editing-addon":T.value,"onUpdate:open":e[3]||(e[3]=s=>{_.value=s,s||(T.value=null)}),onAddonAdded:Z,onAddonUpdated:ee},null,8,["is-open","editing-addon"])]))}}),Ks=pe($s,[["__scopeId","data-v-6431e772"]]);export{Ks as default};
